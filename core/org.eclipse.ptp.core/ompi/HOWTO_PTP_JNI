/*******************************************************************************
 * Copyright (c) 2005 The Regents of the University of California. 
 * This material was produced under U.S. Government contract W-7405-ENG-36 
 * for Los Alamos National Laboratory, which is operated by the University 
 * of California for the U.S. Department of Energy. The U.S. Government has 
 * rights to use, reproduce, and distribute this software. NEITHER THE 
 * GOVERNMENT NOR THE UNIVERSITY MAKES ANY WARRANTY, EXPRESS OR IMPLIED, OR 
 * ASSUMES ANY LIABILITY FOR THE USE OF THIS SOFTWARE. If software is modified 
 * to produce derivative works, such modified software should be clearly marked, 
 * so as not to confuse it with the version available from LANL.
 * 
 * Additionally, this program and the accompanying materials 
 * are made available under the terms of the Eclipse Public License v1.0
 * which accompanies this distribution, and is available at
 * http://www.eclipse.org/legal/epl-v10.html
 * 
 * LA-CC 04-115
 *******************************************************************************/
 
## At some point we'll figure out how to put this in the toolchain but for
## now, here's how to do this:

## Assumption: the class that is making the JNI calls is
##  org.eclipse.ptp.rtsystem.ompi.OMPIJNIBroker(.class)
## Assumption: the directory you're placing this is
##  /Users/ndebard/eclipse-workspace
## Assumption: MAC-OSX

## GOTO THE CORRECT PLACE SO THAT YOU CAN RUN JAVAH
cd ~/eclipse-workspace/org.eclipse.ptp.core/bin
javah -jni -o ptp_ompi_jni.h org.eclipse.ptp.rtsystem.ompi.OMPIJNIBroker

## MOVE THE RESULTING HEADER FILE INTO PLACE
mv ptp_ompi_jni.h ~/eclipse-workspace/org.eclipse.ptp.core/ompi

## RELOCATE TO THE DIRECTORY WHERE THE JNI WILL RESIDE
cd ~/eclipse-workspace/org.eclipse.ptp.core/ompi

## CREATE/EDIT ptp_ompi_jni.c
. . .

## COMPILE ptp_ompi_jni.c INTO AN OBJECT
## ON MAC OSX
mpicc -c -I/System/Library/Frameworks/JavaVM.framework/Headers ptp_ompi_jni.c

## ON LINUX - REPLACE WITH YOUR JDK PATH
mpicc -I /usr/java/jdk1.5.0_04/include -I /usr/java/jdk1.5.0_04/include/linux -c ptp_ompi_jni.c -fPIC

## MAKE THE JNILIB
## ON MAC OSX
mpicc -dynamiclib -o libptp_ompi_jni.jnilib ptp_ompi_jni.o -framework JavaVM -single_module -flat_namespace -undefined suppress

## ON LINUX - REPLACE WITH YOUR JDK PATH
mpicc -I /usr/java/jdk1.5.0_04/include -I /usr/java/jdk1.5.0_04/include/linux -shared -o libptp_ompi_jni.so ptp_ompi_jni.o

## SETUP ECLIPSE TO UNDERSTAND WHERE TO FIND THE JNILIB
## IN THE RUN.. FOR THE NEW INSTANCE OF ECLIPSE/PTP SET THE VM ARGUMENTS
-Djava.library.path=/Users/ndebard/eclipse-workspace/org.eclipse.ptp.core/ompi

## RUN PTP - SHOULD WORK
