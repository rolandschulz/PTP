#

srcdir =	@srcdir@
prefix =	@prefix@
exec_prefix =	@exec_prefix@
bindir =	@bindir@
libdir =	@libdir@

CC =		@CC@
CPPFLAGS =	@CPPFLAGS@
CFLAGS =	@CFLAGS@
LDFLAGS =	@LDFLAGS@
DEFS =		@DEFS@
INSTALL =	@INSTALL@
INSTALL_PROGRAM =	@INSTALL_PROGRAM@
INSTALL_DATA =	@INSTALL_DATA@
RANLIB =	@RANLIB@
AR =		ar
RPCGEN =	@RPCGEN@
REMOVE =	rm -f

TOP =		$(srcdir)/../..
LIB_aif =	@LIB_aif@
INCLUDE_aif =	@INCLUDE_aif@
UTILS =		$(srcdir)/../utils
LIB_libmigdb =	@LIB_libmigdb@
INCLUDE_libmigdb =	@INCLUDE_libmigdb@
ALL_CFLAGS =	$(CPPFLAGS) $(DEFS) -DBINDIR=\"$(bindir)\" -I$(srcdir) -I$(TOP)/include $(INCLUDE_aif) $(INCLUDE_libmigdb) $(CFLAGS)
INSPROGS =	sdmserver

SHELL =		/bin/sh
.SUFFIXES:
.SUFFIXES: .c .o
.c.o:
	$(CC) -c $(ALL_CFLAGS) $<

LIBS =		$(LIB_aif) $(LIB_libmigdb) @LIBS@ -lm

RPCGENFLAGS =

SRCS =		server.c srv_funcs.c

OBJS =		server.o srv_funcs.o

all:	sdmserver

depend:
	cp Makefile Makefile.bak
	sed -n '1,/^# DO NOT REMOVE THIS LINE/p' < Makefile > makedep
	$(CC) -MM $(ALL_CFLAGS) $(RPC_SRCS) $(SRCS) >> makedep
	mv makedep Makefile

clean:
	$(REMOVE) sdmserver a.out core *.o *.a

distclean: clean
	$(REMOVE) Makefile Makefile.bak

install-dirs:
	$(srcdir)/../../mkinstalldirs $(bindir) $(libdir)

install-progs:
	for i in $(INSPROGS); do \
		$(REMOVE) $(bindir)/$$i; \
		$(INSTALL_PROGRAM) $$i $(bindir)/$$i; \
	done

install-libs:
	for i in $(INSLIBS); do \
		$(REMOVE) $(libdir)/$$i; \
		$(INSTALL_DATA) $$i $(libdir)/$$i; \
	done

install: all install-dirs install-progs install-libs

sdmserver: $(OBJS)
	$(CC) $(CFLAGS) $(LDFLAGS) -o sdmserver $(OBJS) $(LIBS)
	
# DO NOT REMOVE THIS LINE
